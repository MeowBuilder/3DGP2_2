## 3DGP-2 프로젝트 TerrainPlayer 통합 변경사항 요약

이 문서는 `TerrainPlayer참조` 프로젝트의 TerrainPlayer 로직을 `3DGP-2` 프로젝트에 통합하기 위해 수행된 변경사항을 요약합니다. 기존 로직을 최대한 보존하고 새로운 `CTerrainPlayer` 클래스를 추가하는 방향으로 진행되었습니다.

### 1. `Mesh.h` 및 `Mesh.cpp` 변경사항

*   **목표:** `TerrainPlayer참조` 프로젝트에서 사용된 `CHeightMapGridMesh` 클래스를 `3DGP-2` 프로젝트의 명명 규칙 및 `CTerrainPlayer`의 기대치에 맞게 `CHeightMapTerrain`으로 이름을 변경했습니다.
*   **`C:\Users\tta12\Downloads\3DGP 2차과제\3DGP-2\Mesh.h`:**
    *   `class CHeightMapGridMesh : public CMesh` 선언을 `class CHeightMapTerrain : public CMesh`로 변경했습니다.
*   **`C:\Users\tta12\Downloads\3DGP 2차과제\3DGP-2\Mesh.cpp`:**
    *   `CHeightMapGridMesh`의 생성자, 소멸자, `OnGetHeight`, `OnGetColor` 메서드의 이름을 `CHeightMapTerrain`에 맞게 변경했습니다.

### 2. `Player.h` 변경사항

*   **목표:** `CTerrainPlayer` 클래스 정의를 추가하고, `CPlayer`의 셰이더 변수 관련 메서드 오버라이드를 수정하여 `CGameObject`의 기본 구현을 호출하도록 했습니다.
*   **`C:\Users\tta12\Downloads\3DGP 2차과제\3DGP-2\Player.h`:**
    *   `CAirplanePlayer` 클래스 정의 뒤에 `CTerrainPlayer` 클래스 정의를 추가했습니다.
        ```cpp
        class CTerrainPlayer : public CPlayer
        {
        public:
            CTerrainPlayer(ID3D12Device *pd3dDevice, ID3D12GraphicsCommandList *pd3dCommandList, ID3D12RootSignature *pd3dGraphicsRootSignature, void *pContext=NULL, int nMeshes = 1);
            virtual ~CTerrainPlayer();

            virtual CCamera *ChangeCamera(DWORD nNewCameraMode, float fTimeElapsed);

            virtual void OnPlayerUpdateCallback(float fTimeElapsed);
            virtual void OnCameraUpdateCallback(float fTimeElapsed);
        };
        ```
    *   `CPlayer` 클래스 내에서 셰이더 변수 관련 가상 함수들을 `CGameObject`의 구현을 호출하도록 수정했습니다.
        ```cpp
        virtual void CreateShaderVariables(ID3D12Device *pd3dDevice, ID3D12GraphicsCommandList *pd3dCommandList) { CGameObject::CreateShaderVariables(pd3dDevice, pd3dCommandList); }
        virtual void ReleaseShaderVariables() { CGameObject::ReleaseShaderVariables(); }
        virtual void UpdateShaderVariables(ID3D12GraphicsCommandList *pd3dCommandList) { CGameObject::UpdateShaderVariables(pd3dCommandList); }
        ```

### 3. `Player.cpp` 변경사항

*   **목표:** `CTerrainPlayer` 클래스의 구현을 추가하고, 필요한 include를 포함하며, 불필요한 상수 버퍼 관련 코드를 제거했습니다.
*   **`C:\Users\tta12\Downloads\3DGP 2차과제\3DGP-2\Player.cpp`:**
    *   `CAirplanePlayer::ChangeCamera` 메서드 구현 뒤에 `CTerrainPlayer`의 생성자, 소멸자, `ChangeCamera`, `OnPlayerUpdateCallback`, `OnCameraUpdateCallback` 메서드 구현을 추가했습니다.
        *   `CTerrainPlayer` 생성자에서 `CPlayer` 기본 생성자의 시그니처 차이로 인해 멤버 변수(`m_xmf3Position`, `m_xmf3Right`, `m_xmf3Up`, `m_xmf3Look`, `m_xmf3Velocity`, `m_xmf3Gravity`, `m_fMaxVelocityXZ`, `m_fMaxVelocityY`, `m_fFriction`, `m_fPitch`, `m_fRoll`, `m_fYaw`)를 명시적으로 초기화했습니다.
        *   `CreateShaderVariables(pd3dDevice, pd3dCommandList);` 호출의 주석을 해제했습니다.
        *   `CScene::CreateConstantBufferView`를 호출하는 불필요한 주석 처리된 코드를 제거했습니다.
    *   파일 상단에 `Mesh.h`를 포함하도록 추가했습니다.
        ```cpp
        #include "stdafx.h"
        #include "Player.h"
        #include "Shader.h"
        #include "Scene.h"
        #include "Mesh.h" // 추가됨
        ```

### 4. `Scene.h` 변경사항

*   **목표:** `CHeightMapTerrain`에 대한 전방 선언과 `m_pTerrain` 멤버 변수가 이미 존재함을 확인했습니다. 추가적인 변경은 필요하지 않았습니다.

### 5. `Scene.cpp` 변경사항

*   **목표:** `CScene::BuildObjects`에서 `CHeightMapTerrain`을 인스턴스화하고, `CTerrainPlayer`를 생성하여 `m_pPlayer`에 할당하며, `m_pTerrain`을 `CTerrainPlayer`의 컨텍스트로 전달하도록 수정했습니다. 또한 `m_pPlayer`가 `CScene::ReleaseObjects`에서 올바르게 해제되도록 했습니다.
*   **`C:\Users\tta12\Downloads\3DGP 2차과제\3DGP-2\Scene.cpp`:**
    *   `CScene::BuildObjects` 내에서 `m_pTerrain` 인스턴스화 코드 뒤에 `CTerrainPlayer`를 인스턴스화하고 `m_pPlayer`에 할당하는 코드를 추가했습니다.
        ```cpp
        m_pTerrain = new CHeightMapTerrain(pd3dDevice, pd3dCommandList, m_pd3dGraphicsRootSignature, _T("Terrain/HeightMap.raw"), 257, 257, 257, 257, xmf3Scale, xmf4Color);

        m_pPlayer = new CTerrainPlayer(pd3dDevice, pd3dCommandList, m_pd3dGraphicsRootSignature, m_pTerrain);
        ```
    *   `CScene::ReleaseObjects` 내에서 `m_pPlayer`를 해제하는 코드를 추가했습니다.
        ```cpp
        if (m_pPlayer) m_pPlayer->Release();
        ```

### 6. `GameFramework.cpp` 변경사항

*   **목표:** `CGameFramework::BuildObjects`에서 `CAirplanePlayer` 대신 `CTerrainPlayer`를 인스턴스화하도록 수정했습니다.
*   **`C:\Users\tta12\Downloads\3DGP 2차과제\3DGP-2\GameFramework.cpp`:**
    *   `CGameFramework::BuildObjects` 내에서 `CAirplanePlayer`를 생성하고 `m_pPlayer`에 할당하는 코드를 `CTerrainPlayer`를 생성하고 `m_pPlayer`에 할당하는 코드로 변경했습니다.
        ```cpp
        CTerrainPlayer *pTerrainPlayer = new CTerrainPlayer(m_pd3dDevice, m_pd3dCommandList, m_pScene->GetGraphicsRootSignature(), m_pScene->m_pTerrain);
        m_pScene->m_pPlayer = m_pPlayer = pTerrainPlayer;
        ```

이러한 변경사항은 `3DGP-2` 프로젝트에 `TerrainPlayer` 기능을 성공적으로 통합하고, 플레이어가 지형과 상호작용하는 로직을 구현합니다.
